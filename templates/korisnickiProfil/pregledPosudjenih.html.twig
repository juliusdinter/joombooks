{% extends 'base.html.twig' %}

{% block title %}Posuđeneee index{% endblock %}



{% block body %}
    <h1>Posudjene index</h1>

    {% if is_granted('ROLE_USER') %}
        <p>{{ korisnik.ime }}</p>
        <p>{{ korisnik.prezime }}</p>
        <td><img width="100px" src="{{ korisnik.fotografija }}" alt="profilna fotografija"></td>
    {% endif %}

    <table class="table">
        <thead>
        <tr>
            {% if is_granted('ROLE_LIBRARY') %}
                <th>Id</th>
                <th>ISBN</th>
            {% endif %}

            <th>Status</th>
            <th>Naslov</th>
            <th>Autori</th>
            {% if is_granted('ROLE_USER') %}
                <th>Ime knjižnice</th>
            {% endif %}
            <th>Fotografija</th>
            <th>Izdavač</th>
            <th>Opis</th>
            <th>DatumDodavanja</th>
            <th>GodinaIzdanja</th>
            <th>Jezik</th>
            <th>Rok povratka</th>
            <th>Zakasnina</th>
            <th>Opcije</th>
        </tr>
        </thead>
        <tbody>
        {% for posudba in posudbe %}
            <tr>
                <td>{{ posudba.id }}</td>
                <td>{{ posudba.gradja.isbn }}</td>
                <td>{{ posudba.getGradja.getNaslov }}</td>
                <td>{{ posudba.getGradja.getKnjiznicaVlasnik.getNaziv }}</td>
                <td><img width="100px" src="{{ posudba.getGradja.fotografija }}"></td>
                <td>{{ posudba.getGradja.izdavac.naziv}}</td>
                <td>{{ posudba.getGradja.opis }}</td>
                <td>{{ posudba.datumPosudbe ? posudba.datumPosudbe |date('Y-m-d') : '' }}</td>
                <td>{{ posudba.datumVracanja ? posudba.datumVracanja|date('Y-m-d') : '' }}</td>
                <td>{{ posudba.getGradja.jezici.ime }}</td>
                <td>{{ posudba.datumVracanja ? posudba.datumVracanja|date('Y-m-d') : '' }}</td>
                <td>{{ posudba.zakasnina }}</td>
                <img src="data:image/png;base64,{{ code.makeBarcode(  posudba.gradja.brojInventara  , "Code128").generate }}"
                     alt="Broj inventara: {{ posudba.gradja.brojInventara  }}"/>
                <td>
                    <a href="#">Produži</a>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="11">no records found</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% if is_granted('ROLE_LIBRARY') %}
        <a href="{{ path('gradja_new') }}">Create new</a>
    {% else %}
        <a href="{{ path('korisnicki_izbornik') }}">HOME</a>
    {% endif %}
{% endblock %}
